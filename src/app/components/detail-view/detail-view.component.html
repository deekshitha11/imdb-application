<div class="detail-view-container">
    <app-loading *ngIf="loading"></app-loading>
    <div class="header-container d-flex flex-column" *ngIf="!loading && item">
        <div class="detail-info d-flex flex-column">
            <div class="detail-header">
                <h1 class="pt-5 pb-0">{{item.title || item.name}}</h1>
                <span>{{(item.release_date || item.first_air_date) | date: 'yyyy'}}</span>
                <span *ngIf="isMovies">{{item.runtime | m2h}}</span>
                <span *ngIf="!isMovies">{{item.number_of_seasons}} Seasons</span>
                <span><i class="bi bi-star-fill"></i>&nbsp;{{item.vote_average}}</span>
            </div>
            <div class="detail-footer">
                <p class="pt-3">{{item.overview}}</p>
                <button class="btn-trailer">Watch Trailer</button>
            </div>
        </div>
        <div class="detail-backdrop" [style.background-image]="getBackgroundUrl(item.backdrop_path)"></div>
    </div>
    <div class="details-container d-flex flex-row pt-5 pl-5 pr-5" *ngIf="!loading && item">
        <div class="poster-area">
            <img src="{{getPosterUrl(item.poster_path)}}">
        </div>
        <div class="details-area d-flex flex-column pl-5 pr-5">
            <div class="plot">
                <h2>Plot</h2>
                <p>{{item.overview}}</p>
            </div>
            <ul class="details-list pl-0">
                <li class="detail-row">
                    <span class="label">Release date:</span>
                    <span class="value">{{(item.release_date || item.first_air_date) | date : 'mediumDate'}}</span>
                </li>
                <li class="detail-row" *ngIf="isMovies">
                    <span class="label">Runtime:</span>
                    <span class="value">{{item.runtime | m2h}}</span>
                </li>
                <li class="detail-row">
                    <span class="label">Score:</span>
                    <span class="value"><i class="bi bi-star-fill"></i>&nbsp;{{item.vote_average}} ({{item.vote_count}})</span>
                </li>
                <li class="detail-row" *ngIf="isMovies">
                    <span class="label">Budget:</span>
                    <span class="value">{{item.budget | currency: 'USD' : 'symbol' : '1.0-0'}}</span>
                </li>
                <li class="detail-row" *ngIf="isMovies">
                    <span class="label">Revenue:</span>
                    <span class="value">{{item.revenue | currency: 'USD' : 'symbol' : '1.0-0'}}</span>
                </li>
                <li class="detail-row" *ngIf="!isMovies">
                    <span class="label">Seasons:</span>
                    <span class="value">{{item.number_of_seasons}}</span>
                </li>
                <li class="detail-row" *ngIf="!isMovies">
                    <span class="label">Episodes:</span>
                    <span class="value">{{item.number_of_episodes}}</span>
                </li>
            </ul>
            <div class="genre-list">
                <button class="btn-genre mb-2" *ngFor="let genre of item.genres" routerLink="/genres/{{genre.id}}/{{genre.name}}">{{genre.name}}</button>
            </div>
        </div>
    </div>
    <div class="cast-container pt-5" *ngIf="credits.length > 0  && !loading">
        <h2 class="pl-3 pb-3">Cast</h2>
        <p-carousel [value]="credits"
            [numVisible]="6" 
            [numScroll]="6" 
            [responsiveOptions]="responsiveOptions" 
            [showIndicators]="false">
            <ng-template let-actor pTemplate="item">
                <app-card [item]="actor" [type]="'actors'" [isPerson]="true"></app-card>
            </ng-template>
        </p-carousel>
    </div>
    <div class="carousel-container pt-5 pb-5" *ngIf="similar && !loading">
        <h2 class="pl-3 pb-3">Similar Movies</h2>
        <p-carousel [value]="similar!"
            [numVisible]="6" 
            [numScroll]="6" 
            [responsiveOptions]="responsiveOptions" 
            [showIndicators]="false">
            <ng-template let-movie pTemplate="item">
                <app-card [item]="movie" [type]="isMovies ? 'movies' : 'shows'"></app-card>
            </ng-template>
        </p-carousel>
    </div>
</div>
